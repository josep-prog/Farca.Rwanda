# ğŸ—ï¸ BuildMart Architecture & Data Flow Diagrams

## 1. Application Structure Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         BUILDMART APP                           â”‚
â”‚                    (React + TypeScript + Vite)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚              â”‚              â”‚
    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
    â”‚ Providers â”‚  â”‚ Routing  â”‚   â”‚   Pages  â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ Auth      â”‚  â”‚ React    â”‚   â”‚ Customer â”‚
    â”‚ Cart      â”‚  â”‚ Router   â”‚   â”‚ Admin    â”‚
    â”‚ Query     â”‚  â”‚ DOM      â”‚   â”‚ Auth     â”‚
    â”‚ Tooltip   â”‚  â”‚          â”‚   â”‚          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚              â”‚              â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                         â”‚
       â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
       â”‚ Components â”‚            â”‚   Hooks  â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚ UI (40+)  â”‚            â”‚ useAuth  â”‚
       â”‚ Layout    â”‚            â”‚ useCart  â”‚
       â”‚ Admin     â”‚            â”‚ useToast â”‚
       â”‚ Products  â”‚            â”‚useMobile â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 2. User Authentication Flow

```
                        LOGIN/SIGNUP FLOW
                                
    CUSTOMER SIDE                          ADMIN SIDE
    (/auth)                               (/authadmin)
        â”‚                                     â”‚
        â”œâ”€ Email/Password                     â”œâ”€ Email/Password
        â”œâ”€ Sign Up with Full Name             â””â”€ Admin Only
        â”‚                                      
    â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”
    â”‚   Supabase Authentication Service           â”‚
    â”‚   â”œâ”€ Create auth.users record             â”‚
    â”‚   â”œâ”€ Generate JWT token                   â”‚
    â”‚   â”œâ”€ Set session (localStorage)          â”‚
    â”‚   â””â”€ Emit auth state change               â”‚
    â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
        â”‚                                      â”‚
    â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
    â”‚ useAuth Hook         â”‚          â”‚ useAuth Hook â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ Receives user info   â”‚          â”‚ Receives     â”‚
    â”‚ Sets isAdmin = false â”‚          â”‚ user info    â”‚
    â”‚ Stores in context    â”‚          â”‚ Queries      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚ user_roles   â”‚
        â”‚                             â”‚ table        â”‚
        â”‚                             â”‚ Sets isAdmin â”‚
        â”‚                             â”‚ = true/false â”‚
        â”‚                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
        â”‚                                      â”‚
    â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”
    â”‚         ProtectedAdminRoute                  â”‚
    â”‚    â”Œâ”€ Is auth loading?                      â”‚
    â”‚    â”œâ”€ Does user exist?                      â”‚
    â”‚    â””â”€ Is isAdmin === true?                  â”‚
    â”‚         â”‚                                    â”‚
    â”‚         â”œâ”€ YES â†’ Render admin page           â”‚
    â”‚         â””â”€ NO â†’ Redirect to /authadmin       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 3. Database Schema Relationship Diagram

```
                          DATABASE STRUCTURE
                       (Supabase PostgreSQL)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   auth.users         â”‚  (Managed by Supabase Auth)
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ id (UUID)        â”‚ â”‚
â”‚ â”‚ email            â”‚ â”‚
â”‚ â”‚ encrypted_password
â”‚ â”‚ created_at       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
      â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                   â”‚              â”‚
      â”‚                   â”‚              â”‚
â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   profiles   â”‚  â”‚ user_roles  â”‚  â”‚  cart_items  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (FK)      â”‚  â”‚ id          â”‚  â”‚ id           â”‚
â”‚ email        â”‚  â”‚ user_id(FK) â”‚  â”‚ user_id(FK) â—„â”€â”€â”
â”‚ full_name    â”‚  â”‚ role        â”‚  â”‚ product_id  â”‚   â”‚
â”‚ phone        â”‚  â”‚ UNIQUE()    â”‚  â”‚ quantity    â”‚   â”‚
â”‚ address      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚ created_at   â”‚                          â”‚           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚        (User Data)
                                          â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                    â”‚                     â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚   products    â”‚                  â”‚    orders     â”‚    â”‚categories  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id            â”‚â—„â”€â”€â”€â”€â”€â”           â”‚ id            â”‚    â”‚ id         â”‚
â”‚ category_id   â”‚      â”‚           â”‚ user_id(FK)   â”‚    â”‚ name       â”‚
â”‚ name          â”‚      â”‚           â”‚ client_name   â”‚    â”‚ slug       â”‚
â”‚ slug          â”‚      â”‚           â”‚ client_email  â”‚    â”‚ icon       â”‚
â”‚ price         â”‚      â”‚           â”‚ total_amount  â”‚    â”‚ color      â”‚
â”‚ discount%     â”‚      â”‚           â”‚ order_status  â”‚    â”‚ created_at â”‚
â”‚ stock         â”‚      â”‚           â”‚ payment_statusâ”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ images[]      â”‚      â”‚           â”‚ created_at    â”‚
â”‚ is_featured   â”‚      â”‚           â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ created_at    â”‚      â”‚               â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚               â”‚
    â”‚                  â”‚               â”‚
    â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
    â”‚         â”‚                        â”‚
    â”‚    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    â”‚   order_items     â”‚   â”‚  (Contains    â”‚
    â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚   line items  â”‚
    â”‚    â”‚ id                â”‚   â”‚   for each    â”‚
    â”‚    â”‚ order_id(FK)      â”‚   â”‚   order)      â”‚
    â””â”€â”€â”€â”€â–ºproduct_id(FK)     â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ quantity          â”‚
         â”‚ unit_price        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RELATIONSHIPS:
â€¢ auth.users â”€1:Mâ”€ profiles (cascade delete)
â€¢ auth.users â”€1:Mâ”€ user_roles (cascade delete)
â€¢ auth.users â”€1:Mâ”€ cart_items (cascade delete)
â€¢ auth.users â”€1:Mâ”€ orders (set null on delete)
â€¢ categories â”€1:Mâ”€ products (set null on delete)
â€¢ products â”€1:Mâ”€ cart_items (cascade delete)
â€¢ products â”€1:Mâ”€ order_items (set null on delete)
â€¢ orders â”€1:Mâ”€ order_items (cascade delete)
```

## 4. Component Tree

```
                        â”Œâ”€ App.tsx
                        â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚           â”‚           â”‚
        Providers    Router      Pages
            â”‚           â”‚           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â”‚               â”‚   â”‚    â”‚             â”‚
AuthProvider    CartProvider Routes    [Components]
    â”‚               â”‚   â”‚         â”‚
    â”‚               â”‚   â”‚         â”œâ”€ /
    â”‚               â”‚   â”‚         â”‚  â””â”€ Index
    â”‚               â”‚   â”‚         â”‚     â””â”€ Layout
    â”‚               â”‚   â”‚         â”‚        â”œâ”€ Header
    â”‚               â”‚   â”‚         â”‚        â”œâ”€ ProductCard
    â”‚               â”‚   â”‚         â”‚        â””â”€ Footer
    â”‚               â”‚   â”‚         â”‚
    â”‚               â”‚   â”‚         â”œâ”€ /products
    â”‚               â”‚   â”‚         â”‚  â””â”€ Products
    â”‚               â”‚   â”‚         â”‚     â””â”€ Layout
    â”‚               â”‚   â”‚         â”‚        â”œâ”€ ProductCard (grid)
    â”‚               â”‚   â”‚         â”‚        â””â”€ Search/Filter
    â”‚               â”‚   â”‚         â”‚
    â”‚               â”‚   â”‚         â”œâ”€ /products/:slug
    â”‚               â”‚   â”‚         â”‚  â””â”€ ProductDetail
    â”‚               â”‚   â”‚         â”‚     â””â”€ Tabs
    â”‚               â”‚   â”‚         â”‚        â”œâ”€ General info
    â”‚               â”‚   â”‚         â”‚        â””â”€ Technical specs
    â”‚               â”‚   â”‚         â”‚
    â”‚               â”‚   â”‚         â”œâ”€ /auth
    â”‚               â”‚   â”‚         â”‚  â””â”€ Auth
    â”‚               â”‚   â”‚         â”‚     â””â”€ Login/Signup form
    â”‚               â”‚   â”‚         â”‚
    â”‚               â”‚   â”‚         â””â”€ /admin/* (Protected)
    â”‚               â”‚   â”‚            â””â”€ ProtectedAdminRoute
    â”‚               â”‚   â”‚               â”œâ”€ /admin
    â”‚               â”‚   â”‚               â”‚  â””â”€ Dashboard
    â”‚               â”‚   â”‚               â”‚     â”œâ”€ AdminLayout
    â”‚               â”‚   â”‚               â”‚     â”œâ”€ Stat Cards
    â”‚               â”‚   â”‚               â”‚     â””â”€ Charts
    â”‚               â”‚   â”‚               â”‚
    â”‚               â”‚   â”‚               â”œâ”€ /admin/products
    â”‚               â”‚   â”‚               â”‚  â””â”€ AdminProducts
    â”‚               â”‚   â”‚               â”‚     â”œâ”€ AdminLayout
    â”‚               â”‚   â”‚               â”‚     â”œâ”€ Table
    â”‚               â”‚   â”‚               â”‚     â”œâ”€ Dialog (CRUD)
    â”‚               â”‚   â”‚               â”‚     â””â”€ Image Upload
    â”‚               â”‚   â”‚               â”‚
    â”‚               â”‚   â”‚               â”œâ”€ /admin/categories
    â”‚               â”‚   â”‚               â”‚  â””â”€ AdminCategories
    â”‚               â”‚   â”‚               â”‚     â”œâ”€ AdminLayout
    â”‚               â”‚   â”‚               â”‚     â””â”€ Grid
    â”‚               â”‚   â”‚               â”‚
    â”‚               â”‚   â”‚               â”œâ”€ /admin/orders
    â”‚               â”‚   â”‚               â”‚  â””â”€ AdminOrders
    â”‚               â”‚   â”‚               â”‚     â”œâ”€ AdminLayout
    â”‚               â”‚   â”‚               â”‚     â””â”€ Table
    â”‚               â”‚   â”‚               â”‚
    â”‚               â”‚   â”‚               â”œâ”€ /admin/users
    â”‚               â”‚   â”‚               â”‚  â””â”€ AdminUsers
    â”‚               â”‚   â”‚               â”‚     â”œâ”€ AdminLayout
    â”‚               â”‚   â”‚               â”‚     â””â”€ Table
    â”‚               â”‚   â”‚               â”‚
    â”‚               â”‚   â”‚               â””â”€ /admin/analytics
    â”‚               â”‚   â”‚                  â””â”€ AdminAnalytics
    â”‚               â”‚   â”‚                     â”œâ”€ AdminLayout
    â”‚               â”‚   â”‚                     â””â”€ Charts
    â”‚               â”‚   â”‚
    â”‚               â”‚   â””â”€ [UI Components - 40+ from shadcn/ui]
    â”‚               â”‚      â”œâ”€ Form: Input, Button, Select
    â”‚               â”‚      â”œâ”€ Dialog: Dialog, AlertDialog
    â”‚               â”‚      â”œâ”€ Data: Table, Card, Tabs
    â”‚               â”‚      â””â”€ Feedback: Toast, Popover
    â”‚               â”‚
    â”‚               â””â”€ Hooks Integration
    â”‚
    â””â”€ useAuth() & useCart() Available in any component
```

## 5. Data Flow: "Add to Cart" Feature

```
USER INTERACTION:
         â”‚
    Click "Add to Cart" Button (ProductCard)
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  ProductCard Component                 â”‚
    â”‚  â”œâ”€ const { addToCart } = useCart()   â”‚
    â”‚  â””â”€ onClick={() => addToCart(id)}     â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Triggers: addToCart(productId, quantity=1)
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  useCart Hook Logic                       â”‚
    â”‚  â”œâ”€ Check: if (!user) {                  â”‚
    â”‚  â”‚    toast.error("Sign in first")       â”‚
    â”‚  â”‚    return                              â”‚
    â”‚  â”‚  }                                     â”‚
    â”‚  â”‚                                        â”‚
    â”‚  â””â”€ Check if product already in cart     â”‚
    â”‚     â”œâ”€ YES: updateQuantity()             â”‚
    â”‚     â””â”€ NO: INSERT into cart_items        â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Supabase INSERT Operation                â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚ INSERT INTO cart_items               â”‚ â”‚
    â”‚  â”‚ (user_id, product_id, quantity)      â”‚ â”‚
    â”‚  â”‚ VALUES (user.id, productId, 1)       â”‚ â”‚
    â”‚  â”‚                                       â”‚ â”‚
    â”‚  â”‚ ON CONFLICT(user_id, product_id)     â”‚ â”‚
    â”‚  â”‚ DO UPDATE SET quantity = quantity+1  â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Database writes record
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Fetch Updated Cart                       â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚ SELECT                                â”‚ â”‚
    â”‚  â”‚   id, product_id, quantity,          â”‚ â”‚
    â”‚  â”‚   product(id, name, price, ...)      â”‚ â”‚
    â”‚  â”‚ FROM cart_items                      â”‚ â”‚
    â”‚  â”‚ WHERE user_id = $1                   â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Database returns cart items
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Update React State                       â”‚
    â”‚  setItems(data)                           â”‚
    â”‚  Computed:                                â”‚
    â”‚  â”œâ”€ cartCount = sum(quantities)           â”‚
    â”‚  â””â”€ cartTotal = sum(price Ã— qty Ã— disc)  â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Show Toast Notification                  â”‚
    â”‚  toast.success("Added to cart")            â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  UI Re-renders                            â”‚
    â”‚  â”œâ”€ ProductCard shows success state       â”‚
    â”‚  â”œâ”€ Header updates cart count badge       â”‚
    â”‚  â””â”€ Cart page updates items list          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 6. Admin Product CRUD Flow

```
                    PRODUCTS MANAGEMENT
                     (/admin/products)

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   useEffect() - Load Products    â”‚
    â”‚   â”œâ”€ Fetch all products with     â”‚
    â”‚   â”‚  category joins              â”‚
    â”‚   â””â”€ Set products state          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Products Table Display                   â”‚
    â”‚  â”œâ”€ Search bar (client-side filter)      â”‚
    â”‚  â”œâ”€ Table rows (name, price, stock...)   â”‚
    â”‚  â”œâ”€ Edit button â†’ handleOpenDialog()      â”‚
    â”‚  â””â”€ Delete button â†’ Delete confirmation  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                         â”‚                  â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   CREATE    â”‚           â”‚    READ     â”‚    â”‚    UPDATE   â”‚
    â”‚             â”‚           â”‚             â”‚    â”‚             â”‚
    â”‚ Click "+"   â”‚           â”‚ Fetched on  â”‚    â”‚ Click Edit  â”‚
    â”‚ button      â”‚           â”‚ load        â”‚    â”‚ button      â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                           â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Dialog Opens (Empty)    â”‚          â”‚ Dialog Opens (Prefilled)â”‚
    â”‚ â”œâ”€ name: ""             â”‚          â”‚ â”œâ”€ name: "Tile ABC"     â”‚
    â”‚ â”œâ”€ price: ""            â”‚          â”‚ â”œâ”€ price: "50000"       â”‚
    â”‚ â”œâ”€ category: ""         â”‚          â”‚ â”œâ”€ category: "cat-123"  â”‚
    â”‚ â”œâ”€ stock: ""            â”‚          â”‚ â”œâ”€ stock: "100"         â”‚
    â”‚ â”œâ”€ is_featured: false   â”‚          â”‚ â”œâ”€ is_featured: true    â”‚
    â”‚ â””â”€ images: []           â”‚          â”‚ â””â”€ images: [url1, url2] â”‚
    â”‚                         â”‚          â”‚                         â”‚
    â”‚ User fills form         â”‚          â”‚ User modifies fields    â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                          â”‚
         â”‚ Optional: Select image                   â”‚
         â”‚                                          â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ handleImageSelect()               â”‚
    â”‚ â”œâ”€ Validate type (image only)    â”‚
    â”‚ â”œâ”€ Validate size (<5MB)          â”‚
    â”‚ â”œâ”€ Create preview (DataURL)      â”‚
    â”‚ â””â”€ Store in selectedFile state   â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ User clicks Save
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ handleSaveProduct()                      â”‚
    â”‚                                         â”‚
    â”‚ IF selectedFile exists:                 â”‚
    â”‚  â”œâ”€ uploadImageToStorage(file)         â”‚
    â”‚  â””â”€ Get public URL                     â”‚
    â”‚                                         â”‚
    â”‚ IF editing product:                     â”‚
    â”‚  â””â”€ Append URL to existing images[]    â”‚
    â”‚  ELSE:                                  â”‚
    â”‚  â””â”€ Create new images array with URL   â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Supabase Operation                       â”‚
    â”‚                                           â”‚
    â”‚  IF editingProduct:                       â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚ UPDATE products                      â”‚ â”‚
    â”‚  â”‚ SET name, price, stock, images...  â”‚ â”‚
    â”‚  â”‚ WHERE id = editingProduct.id        â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â”‚  ELSE:                                    â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚ INSERT INTO products                â”‚ â”‚
    â”‚  â”‚ (name, price, stock, images...)     â”‚ â”‚
    â”‚  â”‚ VALUES (...)                         â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  On Success                            â”‚
    â”‚  â”œâ”€ Close dialog                       â”‚
    â”‚  â”œâ”€ Show success toast                 â”‚
    â”‚  â”œâ”€ Fetch updated products list        â”‚
    â”‚  â””â”€ Re-render table                    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


                    DELETE OPERATION

    User clicks Delete button on table row
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ AlertDialog Confirmation           â”‚
    â”‚ "Are you sure? This can't be undone"â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    User confirms deletion
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Supabase DELETE                  â”‚
    â”‚ DELETE FROM products             â”‚
    â”‚ WHERE id = productId             â”‚
    â”‚ (Cascades to order_items)        â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ On Success                       â”‚
    â”‚ â”œâ”€ Show success toast            â”‚
    â”‚ â”œâ”€ Remove from local products[]  â”‚
    â”‚ â””â”€ Re-render table               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 7. State Management Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    REACT CONTEXT PROVIDERS                   â”‚
â”‚                    (Global State)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  AuthContext / AuthProvider       â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ State:                            â”‚
    â”‚ â”œâ”€ user: User | null             â”‚
    â”‚ â”œâ”€ session: Session | null       â”‚
    â”‚ â”œâ”€ isAdmin: boolean              â”‚
    â”‚ â”œâ”€ isLoading: boolean            â”‚
    â”‚                                   â”‚
    â”‚ Methods:                          â”‚
    â”‚ â”œâ”€ signIn(email, password)       â”‚
    â”‚ â”œâ”€ signUp(email, password, name) â”‚
    â”‚ â”œâ”€ signOut()                     â”‚
    â”‚ â””â”€ checkAdminRole(userId)        â”‚
    â”‚                                   â”‚
    â”‚ Listeners:                        â”‚
    â”‚ â””â”€ supabase.auth.onAuthStateChangeâ”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  CartContext / CartProvider                 â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ State:                                       â”‚
    â”‚ â”œâ”€ items: CartItem[]                        â”‚
    â”‚ â”œâ”€ isLoading: boolean                       â”‚
    â”‚                                              â”‚
    â”‚ Computed:                                    â”‚
    â”‚ â”œâ”€ cartCount = sum(item.quantity)           â”‚
    â”‚ â”œâ”€ cartTotal = sum(item.price Ã— qty Ã— disc) â”‚
    â”‚                                              â”‚
    â”‚ Methods:                                     â”‚
    â”‚ â”œâ”€ addToCart(productId, qty)                â”‚
    â”‚ â”œâ”€ updateQuantity(productId, qty)           â”‚
    â”‚ â”œâ”€ removeFromCart(productId)                â”‚
    â”‚ â””â”€ clearCart()                              â”‚
    â”‚                                              â”‚
    â”‚ Listeners:                                   â”‚
    â”‚ â””â”€ useAuth() - watches user changes         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    TANSTACK QUERY (TanStack React Query) â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Manages:                                  â”‚
â”‚ â”œâ”€ Server state caching                  â”‚
â”‚ â”œâ”€ Background refetching                 â”‚
â”‚ â”œâ”€ Request deduplication                 â”‚
â”‚ â”œâ”€ Automatic stale data handling         â”‚
â”‚                                           â”‚
â”‚ Used for:                                 â”‚
â”‚ â”œâ”€ Product fetches                       â”‚
â”‚ â”œâ”€ Order pagination                      â”‚
â”‚ â”œâ”€ Analytics data                        â”‚
â”‚ â””â”€ Real-time data sync                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      LOCAL COMPONENT STATE               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Examples:                                 â”‚
â”‚ â”œâ”€ Dialog open/close state               â”‚
â”‚ â”œâ”€ Form field values                     â”‚
â”‚ â”œâ”€ Filter/search input                   â”‚
â”‚ â”œâ”€ Loading states for requests           â”‚
â”‚ â”œâ”€ Pagination page number                â”‚
â”‚ â””â”€ Expanded rows in tables                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 8. Admin Authentication & Route Protection

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Admin Login Flow                     â”‚
â”‚             (/authadmin)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
         Enter credentials
               â”‚
         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ signIn(email, password) â”‚
         â”‚ (from useAuth hook)     â”‚
         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Supabase Auth.signInWithPassword() â”‚
         â”‚ (Validates credentials)             â”‚
         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ On Success:                      â”‚
         â”‚ â”œâ”€ Create auth.users record      â”‚
         â”‚ â”œâ”€ Generate JWT token            â”‚
         â”‚ â”œâ”€ Emit auth state change        â”‚
         â”‚ â””â”€ useAuth updates user/session  â”‚
         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ checkAdminRole(userId)          â”‚
         â”‚ SELECT FROM user_roles          â”‚
         â”‚ WHERE user_id = userId AND      â”‚
         â”‚       role = 'admin'            â”‚
         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Result:                         â”‚
         â”‚ â”œâ”€ Admin found â†’ isAdmin=true   â”‚
         â”‚ â””â”€ Not admin â†’ isAdmin=false    â”‚
         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Redirect logic:             â”‚
         â”‚ â”œâ”€ If isAdmin=true          â”‚
         â”‚ â”‚  â””â”€ Navigate to /admin    â”‚
         â”‚ â””â”€ If isAdmin=false         â”‚
         â”‚    â””â”€ Show error, stay on   â”‚
         â”‚       /authadmin            â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Protected Admin Route Check            â”‚
â”‚   (Every admin page access)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ ProtectedAdminRoute    â”‚
         â”‚ component mounted      â”‚
         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Check 1: isLoading?             â”‚
         â”‚ â”œâ”€ true â†’ Show spinner         â”‚
         â”‚ â””â”€ false â†’ Continue             â”‚
         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Check 2: user exists?           â”‚
         â”‚ â”œâ”€ true â†’ Continue              â”‚
         â”‚ â””â”€ false â†’ Redirect to /authadminâ”‚
         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Check 3: isAdmin === true?      â”‚
         â”‚ â”œâ”€ true â†’ Render component     â”‚
         â”‚ â””â”€ false â†’ Redirect to /authadminâ”‚
         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ User has access to admin page  â”‚
         â”‚ âœ“ Dashboard                     â”‚
         â”‚ âœ“ Products management           â”‚
         â”‚ âœ“ Orders management             â”‚
         â”‚ âœ“ Analytics                     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 9. Order Management State Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Orders Management Page (/admin/orders)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ useEffect on load:  â”‚
         â”‚ Fetch all orders    â”‚
         â”‚ with status details â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Display Orders Table           â”‚
         â”‚ Columns:                       â”‚
         â”‚ â”œâ”€ Order ID                    â”‚
         â”‚ â”œâ”€ Client Name                 â”‚
         â”‚ â”œâ”€ Items Count                 â”‚
         â”‚ â”œâ”€ Total Amount                â”‚
         â”‚ â”œâ”€ Order Status (badge)        â”‚
         â”‚ â”œâ”€ Payment Status (badge)      â”‚
         â”‚ â””â”€ Actions (View, Edit)        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ User Interactions:                â”‚
         â”‚ â”œâ”€ Search (client-side filter)    â”‚
         â”‚ â”œâ”€ Click row to expand details    â”‚
         â”‚ â””â”€ Click edit to change status    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚             â”‚             â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ View     â”‚ â”‚ Update   â”‚ â”‚ Update       â”‚
â”‚ Order    â”‚ â”‚ Order    â”‚ â”‚ Payment      â”‚
â”‚ Details  â”‚ â”‚ Status   â”‚ â”‚ Status       â”‚
â”‚          â”‚ â”‚          â”‚ â”‚              â”‚
â”‚ Shows:   â”‚ â”‚ Dialog:  â”‚ â”‚ Dialog:      â”‚
â”‚ â”œâ”€ Items â”‚ â”‚ â”œâ”€ Currentâ”‚ â”‚ â”œâ”€ Current  â”‚
â”‚ â”œâ”€ Total â”‚ â”‚ â”‚ status  â”‚ â”‚ â”‚ status    â”‚
â”‚ â””â”€ Clientâ”‚ â”‚ â”œâ”€ Select â”‚ â”‚ â”œâ”€ Select   â”‚
â”‚   info   â”‚ â”‚ â”‚ new     â”‚ â”‚ â”‚ new       â”‚
â”‚          â”‚ â”‚ â”‚ status  â”‚ â”‚ â”‚ status    â”‚
â”‚          â”‚ â”‚ â””â”€ Save   â”‚ â”‚ â””â”€ Save     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚             â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
         â”‚ Supabase UPDATE               â”‚
         â”‚ SET order_status = new_status â”‚
         â”‚ or payment_status = new_statusâ”‚
         â”‚ WHERE id = order_id           â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ On Success:                   â”‚
         â”‚ â”œâ”€ Show toast notification    â”‚
         â”‚ â”œâ”€ Update local state         â”‚
         â”‚ â””â”€ Re-render table            â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

This comprehensive architecture visualization provides a complete picture of how BuildMart's frontend is structured and how data flows through the application! ğŸ—ï¸

